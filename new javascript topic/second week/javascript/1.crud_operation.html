<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.0.2/dist/css/bootstrap.min.css" rel="stylesheet"
        integrity="sha384-EVSTQN3/azprG1Anm3QDgpJLIm9Nao0Yz1ztcQTwFspd3yD65VohhpuuCOmLASjC" crossorigin="anonymous">
    <link rel="stylesheet" href="index.css">
    <link
        href="https://fonts.googleapis.com/css2?family=Poppins:ital,wght@0,100;0,200;0,300;0,400;0,500;0,600;0,700;0,800;0,900;1,100;1,200;1,300;1,400;1,500;1,600;1,700;1,800;1,900&display=swap"
        rel="stylesheet">
</head>

<body>
    <div class="main">
        <div class="form-cnt">
            <div>
                <h2 class="text-center">Input Form</h2>
            </div>
            <form id="form">
                <div class="col-12 mb-3">
                    <label class="mb-2">First Name</label>
                    <input type="text" class="form-control" placeholder="Please Enter First Name" id="firstname">
                    <span class="warn" id="error">
                        <div class="text-center">Please Enter First Name</div>
                    </span>
                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2">Last Name</label>
                    <input type="text" class="form-control" placeholder="Please Enter Last Name" id="lastname">
                    <span class="warn" id="error2">
                        <div class="text-center">Please Enter Last Name</div>
                    </span>

                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2">Gender</label><br>
                    <input class="form-check-input" type="radio" name="gender" value="Male"> Male
                    <input class="form-check-input" type="radio" name="gender" value="Female"> Female
                    <span class="warn" id="error3">
                        <div class="text-center">Please Select Gender </div>
                    </span>

                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2">Language</label><br>
                    <input class="form-check-input" type="checkbox" name="language" value="English"> English
                    <input class="form-check-input" type="checkbox" name="language" value="Hindi"> Hindi
                    <input class="form-check-input" type="checkbox" name="language" value="Gujrati"> Gujrati
                    <span class="warn" id="error4">
                        <div class="text-center">Please Select Language </div>
                    </span>

                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2">City</label>
                    <select class="form-select" aria-label="Default select example" id="city">
                        <option selected value="">Select City</option>
                        <option name="city" value="Surat">Surat</option>
                        <option name="city" value="Rajkot">Rajkot</option>
                        <option name="city" value="Bharuch">Bharuch</option>
                    </select>
                    <span class="warn" id="error5">
                        <div class="text-center">Please Select City </div>
                    </span>
                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2"> Phone</label>
                    <input type="tel" class="form-control" placeholder="Please Enter Phone" id="phone" maxlength="10"
                        minlength="10">
                    <span class="warn" id="error6">
                        <div class="text-center">Please Enter Phone</div>
                    </span>
                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2"> Age</label>
                    <input type="number" class="form-control" placeholder="Please Enter Age" id="age" min="1" max="100">
                    <span class="warn" id="error7">
                        <div class="text-center">Please Enter Age</div>
                    </span>
                </div>

                <div class="col-12 mb-3">
                    <label class="mb-2">Date</label>
                    <input type="date" class="form-control" id="date">
                    <span class="warn" id="error8">
                        <div class="text-center">Please Select Date</div>
                    </span>
                </div>

                <div class=" col-12 mb-3">
                    <label class="form-label">Select Image</label>
                    <input class="form-control" type="file" id="image">
                    <span class="warn" id="error9">
                        <div class="text-center">Please Select Image</div>
                    </span>
                </div>

                <div class="col-12 mb-3 submit">
                    <input class="form-control" type="submit">
                </div>
            </form>
        </div>
    </div>
    <br>
    <br>
    <div>
        <button class="btn btn-primary ms-5 mb-3" id="dateSorting">Sort By Date</button>
    </div>
    <div class="col-3 ms-5 mb-3">
        <label class="mb-2">Search Here</label>
        <input type="text" class="form-control" placeholder="Search Here" id="search">
    </div>


    <div class="flex">
        <div class="col-3 ms-5 mb-3">
            <label class="mb-2">Select City</label>
            <select class="form-select" aria-label="Default select example" id="findCity">
                <option selected value="">Select City</option>
                <option name="city" value="Surat">Surat</option>
                <option name="city" value="Rajkot">Rajkot</option>
                <option name="city" value="Bharuch">Bharuch</option>
            </select>
        </div>

        <div class="col-3 ms-5 mb-3">
            <label class="mb-2">Select Gender</label>
            <select class="form-select" aria-label="Default select example" id="findGender">
                <option name="gender" value="Male">Male</option>
                <option name="gender" value="Female">Female</option>
            </select>
        </div>

        <div class="col-3 me-5 mb-3">
            <label class="mb-2">Select Language</label>
            <select class="form-select" aria-label="Default select example" id="findLanguage">
                <option selected value="">Select Language</option>
                <option name="language" value="English">English</option>
                <option name="language" value="Hindi">Hindi</option>
                <option name="language" value="Gujrati">Gujrati</option>
            </select>
        </div>
    </div>

    <br>
    <br>
    <table class="table" border="1">
        <thead>
            <tr align="center">
                <th>No.</th>
                <th>First Name</th>
                <th>Last Name</th>
                <th>Gender</th>
                <th>Language</th>
                <th>City</th>
                <th>Phone No.</th>
                <th>Age</th>
                <th>Date</th>
                <th>Select Image</th>
                <th>Delete</th>
                <th>Update</th>
            </tr>
        </thead>
        <tbody id="tableBody">
        </tbody>
    </table>

    <script>
        let form = document.getElementById('form')
        // let list = []
        let editIndex = null

        let list = JSON.parse(localStorage.getItem('list-cloud')) || []
        // console.log('list ===>', list);
        getData()


        document.getElementById('age').addEventListener('input', function (e) {
            let value = e.target.value
            // console.log(this.value);

            if (value < 1) {
                this.value = "1"
            } else if (value > 100) {
                this.value = "100"
            }

        })

        document.getElementById('form').addEventListener('submit', function (e) {
            e.preventDefault()

            let firstname = document.getElementById('firstname').value
            // console.log("firstname===>", firstname);

            if (!firstname) {
                document.getElementById('error').style.display = 'block'
            } else {
                document.getElementById('error').style.display = 'none'
            }

            let lastname = document.getElementById('lastname').value
            // console.log("lastname===>", lastname);

            if (!lastname) {
                document.getElementById('error2').style.display = 'block'
            } else {
                document.getElementById('error2').style.display = 'none'
            }

            let gender = document.querySelector('input[name = "gender"]:checked')?.value || ''
            // console.log("gender ===> ", gender);

            if (!gender) {
                document.getElementById('error3').style.display = 'block'
            } else {
                document.getElementById('error3').style.display = 'none'
            }


            let language = Array.from(document.querySelectorAll('input[name = "language"]:checked')).map((el) => el.value)
            // console.log("language ==>", language);

            if (language.length == 0) {
                document.getElementById('error4').style.display = 'block'
            } else {
                document.getElementById('error4').style.display = 'none'
            }

            let city = document.getElementById('city').value
            // console.log('City ==>', city);

            if (!city) {
                document.getElementById('error5').style.display = 'block'
            } else {
                document.getElementById('error5').style.display = 'none'
            }

            let phone = document.getElementById('phone')?.value
            // console.log('phone ==>', phone);

            if (!phone) {
                document.getElementById('error6').style.display = 'block'
            } else {
                document.getElementById('error6').style.display = 'none'
            }

            let age = document.getElementById('age').value
            // console.log('age ==>', age);

            if (!age) {
                document.getElementById('error7').style.display = 'block'
            } else {
                document.getElementById('error7').style.display = 'none'
            }

            let date = document.getElementById('date').value
            // console.log("date ==> ", date);

            if (!date) {
                document.getElementById('error8').style.display = 'block'
            } else {
                document.getElementById('error8').style.display = 'none'
            }

            let image = document.getElementById('image').files[0]
            // console.log("image==>",image);

            if (!image) {
                document.getElementById('error9').style.display = 'block'
            } else {
                document.getElementById('error9').style.display = 'none'
            }


            let imageInput
            if (image) {
                imageInput = URL.createObjectURL(image)
                // console.log("image input ==>",imageInput);
            } else {
                imageInput = ''
            }

            let data = { firstname, lastname, gender, language, city, phone, age, date, imageInput }

            if (editIndex == null) {
                if (firstname !== "" && lastname !== "" && gender !== "" && language.length !== 0 && city !== "" && phone !== "" && age !== "" && date !== "" && imageInput !== "") {
                    list.push(data)
                     form.reset()

                }
            } else {
                if (firstname !== "" && lastname !== "" && gender !== "" && language.length !== 0 && city !== "" && phone !== "" && age !== "" && date !== "" && imageInput !== "") {
                    list[editIndex] = data
                    editIndex = null
                     form.reset()
                }
            }
            localStorage.setItem('list-cloud', JSON.stringify(list))
            getData()
        })

        function getData() {
            let table = document.getElementById('tableBody')
            table.innerHTML = ''

            list.map((el, index) => {
                table.innerHTML += `
                    <tr align="center">
                    <td>${index + 1}</td>
                    <td>${el.firstname}</td>
                    <td>${el.lastname}</td>
                    <td>${el.gender}</td>
                    <td>${el.language}</td>
                    <td>${el.city}</td>
                    <td>${el.phone}</td>
                    <td>${el.age}</td>
                    <td>${el.date}</td>
                    <td><img src="${el.imageInput}" style="width: 100px;height: 100px;" alt="Not Upload"></td>
                    <td><button class="btn btn-primary" onclick="deleteData(${index})">Delete</button></td>
                    <td><button class="btn btn-primary" onclick="updateData(${index})">Update</button></td>
                   </tr>
                `
            })
        }

        function deleteData(index) {
            // console.log(index);
            list.splice(index, 1)
            localStorage.setItem('list-cloud', JSON.stringify(list))
            getData()
        }

        function updateData(index) {
            // console.log(index);

            let data = list[index]
            // console.log("data ==>",data);

            document.getElementById('firstname').value = data.firstname

            document.getElementById('lastname').value = data.lastname

            if (data.gender) {
                document.querySelector(`input[name = "gender"][value = ${data.gender}]`).checked = true
            }

            document.querySelectorAll('input[name = "language"]').forEach(el => el.checked = false)
            data.language.forEach(language => {
                let checkbox = document.querySelector(`input[name = "language"][value  = "${language}"]`)
                if (checkbox) checkbox.checked = true
            })

            document.getElementById('city').value = data.city

            document.getElementById('phone').value = data.phone

            document.getElementById('age').value = data.age

            document.getElementById('date').value = data.date

            editIndex = index
        }

        document.getElementById('search').addEventListener('keypress', function (e) {
            let searchData = e.target.value.toLowerCase()
            // console.log("serchData===>",searchData);
            let filterData = list.filter((el) => {
                return (
                    el.firstname.toLowerCase().includes(searchData) || el.lastname.toLowerCase().includes(searchData) || el.phone.includes(searchData) || el.age.includes(searchData) || el.date.includes(searchData)
                )
            })
            // console.log("filerData==>", filterData);

            if (filterData) {
                search(filterData)
            }
        })

        document.getElementById('findCity').addEventListener('click', function (e) {
            let searchData = e.target.value.toLowerCase()
            // console.log("serchData==>",searchData);

            let filterData = list.filter((el) => {
                return (
                    el.city.toLowerCase().includes(searchData)
                )
            })
            // console.log("filterData==>",filterData);
            if (filterData) {
                search(filterData)
            }
        })

        document.getElementById('findGender').addEventListener('click', function (e) {
            let searchData = e.target.value.toLowerCase()
            // console.log("searchData ===> ",searchData);
            let filterData = list.filter((el) => {
                // console.log("return ==>",  el.gender === searchData);

                return (
                    el.gender.toLowerCase() === searchData
                )
            })
            // console.log("filterData===>",filterData);
            if (filterData) {
                search(filterData)
            }
        })

        document.getElementById('findLanguage').addEventListener('click', function (e) {
            let searchData = e.target.value.toLowerCase()
            // console.log("searchData==>",searchData);
            let filterData = list.filter((el) => {
                return (
                    el.language.join().toLowerCase().includes(searchData)
                )
            })
            // console.log("filterData==>",filterData);
            if (filterData) {
                search(filterData)
            }
        })

        document.getElementById('dateSorting').addEventListener('click', function (e) {

            //    let sortData = list.sort((a,b)=> new Date(a.date) - new Date(b.date))
            let sortData = list.sort((a, b) => {
                // console.log("retun sort a ==>", new Date(a.date));
                // console.log("retun sort b==>", new Date(b.date));         
                return (
                    new Date(a.date) - new Date(b.date)
                    // (a.date) - (b.date)
                )
            })
            //    console.log("sortData===>",sortData);
            if (sortData) {
                sort(sortData)
            }

        })

        function search(filterData) {
            // console.log("filerData==>",filterData);
            let table = document.getElementById('tableBody')
            table.innerHTML = ''

            filterData.map((el, index) => {
                table.innerHTML += `
                    <tr align="center">
                    <td>${index + 1}</td>
                    <td>${el.firstname}</td>
                    <td>${el.lastname}</td>
                    <td>${el.gender}</td>
                    <td>${el.language}</td>
                    <td>${el.city}</td>
                    <td>${el.phone}</td>
                    <td>${el.age}</td>
                    <td>${el.date}</td>
                    <td><img src="${el.imageInput}" style="width: 100px;height: 100px;" alt="Not Upload"></td>
                    <td><button class="btn btn-primary" onclick="deleteData(${index})">Delete</button></td>
                    <td><button class="btn btn-primary" onclick="updateData(${index})">Update</button></td>
                   </tr>
                `
            })
        }

        function sort(sortData) {
            console.log("sortData==>", sortData);
            let table = document.getElementById('tableBody')
            table.innerHTML = ''

            sortData.map((el, index) => {
                table.innerHTML += `
                    <tr align="center">
                    <td>${index + 1}</td>
                    <td>${el.firstname}</td>
                    <td>${el.lastname}</td>
                    <td>${el.gender}</td>
                    <td>${el.language}</td>
                    <td>${el.city}</td>
                    <td>${el.phone}</td>
                    <td>${el.age}</td>
                    <td>${el.date}</td>
                    <td><img src="${el.imageInput}" style="width: 100px;height: 100px;" alt="Not Upload"></td>
                    <td><button class="btn btn-primary" onclick="deleteData(${index})">Delete</button></td>
                    <td><button class="btn btn-primary" onclick="updateData(${index})">Update</button></td>
                   </tr>
                `
            })
        }
 
    </script>
</body>

</html>